@using Mankura.Models.ViewModels
@model ProfileViewModel

@{
    ViewData["Title"] = "Profile";
}

@if (!ViewData.ModelState.IsValid)
{
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("profileSettings")?.classList.add("open");
        });
    </script>
}

<div class="profile-header">
    <div class="profile-info">
        <div class="profile-avatar">
            <img src="@Model.AvatarUrl" alt="Profile Picture" />
        </div>

        <div class="profile-details">
            <h1>@Model.UserName</h1>
            <p>Email: @Model.Email</p>
        </div>
    </div>

    <button type="button"
            class="settings-btn"
            id="openSettings">
        Settings
    </button>
</div>

<div class="profile-settings-panel" id="profileSettings">
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <h3>Profile settings</h3>

            @await Html.PartialAsync(
            "_ProfileSettings",
                        new ProfileSettingsViewModel
                        {
                            UserName = Model.UserName
                        }
                        )
        </div>
    </div>
</div>

<div class="profile-content">

    <div class="bookmarks-sidebar">
        <h3 class="bookmarks-title">Bookmarks lists</h3>

        <div class="bookmark-lists">

            <label class="bookmark-item">
                <span class="label-text">Read</span>
                <input type="checkbox" value="Read">
                <span class="checkmark"></span>
            </label>

            <label class="bookmark-item">
                <span class="label-text">Readable</span>
                <input type="checkbox" value="Readable">
                <span class="checkmark"></span>
            </label>

            <label class="bookmark-item">
                <span class="label-text">Will be read</span>
                <input type="checkbox" value="Will be read">
                <span class="checkmark"></span>
            </label>

            <label class="bookmark-item">
                <span class="label-text">Favorites</span>
                <input type="checkbox" value="Favorites">
                <span class="checkmark"></span>
            </label>

        </div>

    </div>

    <div class="profile-manga-content">

        @if (!Model.ReadingList.Any())
        {
            <div class="empty-state">
                <p class="empty-text">
                    You don't have any bookmarks at the moment.
                </p>

                <a asp-controller="Catalog"
                   asp-action="Index"
                   class="auth-submit-btn open-catalog-btn">
                    Open Catalog
                </a>
            </div>
        }
        else
        {
            <div class="manga-grid profile-manga-grid">
                @foreach (var manga in Model.ReadingList)
                {
                    <a asp-controller="Manga"
                       asp-action="Details"
                       asp-route-id="@manga.Id"
                       class="manga-card"
                       data-reading="@manga.ReadingType"
                       data-title="@manga.Name">

                        <div class="manga-cover">
                            <img src="@manga.Cover" alt="@manga.Name" />
                        </div>

                        <div class="manga-title">@manga.Name</div>
                        <div class="manga-subtitle">@manga.ReleaseYear</div>
                    </a>
                }
            </div>
        }
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/profile-filter.js"></script>
}